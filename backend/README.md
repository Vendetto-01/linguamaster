# Word Wizard Backend

This directory contains the Node.js (TypeScript) backend for the Word Wizard application.

## Prerequisites

- Node.js (v18+ recommended)
- npm
- A Supabase account and project
- A Gemini API Key

## Setup

1.  **Clone the repository (if you haven't already).**
2.  **Navigate to the backend directory:**
    ```bash
    cd backend
    ```
3.  **Install dependencies:**
    ```bash
    npm install
    ```
4.  **Create a Supabase `words` table:**
    Ensure you have a table named `words` in your Supabase database with the following schema:
    - `id` (SERIAL, PRIMARY KEY)
    - `word` (TEXT, NOT NULL)
    - `part_of_speech` (TEXT, NOT NULL)
    - `definition` (TEXT, NOT NULL)
    - `difficulty_level` (TEXT, NOT NULL)
    - `example_sentence` (TEXT, NOT NULL)
    - `option_a` (TEXT, NOT NULL)
    - `option_b` (TEXT, NOT NULL)
    - `option_c` (TEXT, NOT NULL)
    - `option_d` (TEXT, NOT NULL)
    - `created_at` (TIMESTAMPTZ, DEFAULT `now()`)
    - `updated_at` (TIMESTAMPTZ, DEFAULT `now()`)
    - `update_note` (TEXT, NULLABLE)
    - `placeholder_1` (TEXT, NULLABLE)
    - `placeholder_2` (TEXT, NULLABLE)

5.  **Configure Environment Variables:**
    Create a `.env` file in this `backend` directory by copying `.env.example` (if one exists) or creating it manually.
    Add your specific credentials:
    ```env
    PORT=3001
    SUPABASE_URL=your_supabase_project_url
    SUPABASE_ANON_KEY=your_supabase_anon_key
    GEMINI_API_KEY=your_google_gemini_api_key
    ```
    Replace placeholder values with your actual Supabase URL, anon key, and Gemini API key.

## Running the Application

-   **Development mode (with auto-reloading):**
    ```bash
    npm run dev
    ```
    The server will typically start on `http://localhost:3001`.

-   **Production mode:**
    First, build the TypeScript code:
    ```bash
    npm run build
    ```
    Then, start the server:
    ```bash
    npm start
    ```

## API Endpoints

-   **POST `/api/words`**: Adds a new word entry.
    -   **Request Body:**
        ```json
        {
          "word": "example"
        }
        ```
        The service will use this word to query the Gemini API for definitions, examples, etc., and then store the complete entry.
    -   **Success Response (201 Created):**
        ```json
        {
          "id": 1,
          "word": "example",
          "part_of_speech": "noun",
          "definition": "â€¢ A thing characteristic of its kind or illustrating a general rule.",
          "difficulty_level": "A2",
          "example_sentence": "This is an example sentence.",
          "option_a": "A representative instance.",
          "option_b": "A type of fruit.",
          "option_c": "A musical instrument.",
          "option_d": "A weather phenomenon.",
          "created_at": "2023-10-27T10:00:00.000Z",
          "updated_at": "2023-10-27T10:00:00.000Z",
          "update_note": null,
          "placeholder_1": null,
          "placeholder_2": null
        }
        ```
    -   **Error Responses:**
        -   `400 Bad Request`: If required fields are missing or data is invalid.
        -   `500 Internal Server Error`: If there's an issue with the Gemini API call or database operation.

## Project Structure

-   `src/`: Contains the TypeScript source code.
    -   `config/`: Configuration files (e.g., Supabase client).
    -   `controllers/`: Request handlers that interact with services.
    -   `routes/`: Express route definitions.
    -   `services/`: Business logic, API interactions, database operations.
    -   `types/`: TypeScript type definitions and interfaces.
    -   `index.ts`: Main application entry point.
-   `dist/`: Compiled JavaScript code (generated by `npm run build`).
-   `.env`: Environment variables (ignored by Git).
-   `package.json`: Project metadata and dependencies.
-   `tsconfig.json`: TypeScript compiler options.